<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamVault</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }
        .container {
            max-width: 90%;
        }
        .message-box {
            position: fixed;
            top: 2rem;
            right: 2rem;
            max-width: 300px;
            z-index: 1000;
        }
        .tab-button.active {
            @apply bg-blue-600 text-white;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, addDoc, onSnapshot, collection, query, where, getDocs, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // IMPORTANT: Cloudinary Configuration - You must set your Cloud Name and Upload Preset here.
        const CLOUDINARY_CLOUD_NAME = 'dvvzifhg2'; 
        // ----------------------------------------------------------------------------------------------------
        // IMPORTANT: The upload preset name has been updated based on your input.
        // ----------------------------------------------------------------------------------------------------
        const CLOUDINARY_UPLOAD_PRESET = 'stream'; 

        // Hardcoded Firebase configuration from the user's input.
        const firebaseConfig = {
            apiKey: "AIzaSyAWQzVqIzVT6-d8xw-1SfVlXzPLWsik_t0",
            authDomain: "streamer-3cf9b.firebaseapp.com",
            projectId: "streamer-3cf9b",
            storageBucket: "streamer-3cf9b.firebasestorage.app",
            messagingSenderId: "661085685654",
            appId: "1:661085685654:web:76d44a02c7d40964fbffb7",
            measurementId: "G-QZGEPNDB2G"
        };
        
        // Hardcoded values for variables that would normally be provided by the environment.
        const appId = 'streamvault-app-id';

        let app;
        let auth;
        let db;
        let isFirebaseInitialized = false;

        // Check if firebaseConfig is valid before initializing
        if (firebaseConfig && Object.keys(firebaseConfig).length > 0 && firebaseConfig.apiKey) {
            // Initialize Firebase
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            isFirebaseInitialized = true;
        } else {
            console.error("Firebase configuration is missing or invalid. App will not function correctly.");
        }


        // --- IMPORTANT: CONFIGURATION FOR THE ADMIN'S GOOGLE EMAIL ---
        // This email address will be the only one able to upload videos.
        const adminEmail = 'robloxbestgamer111@gmail.com';

        // --- UI Element References ---
        const authContainer = document.getElementById('auth-container');
        const mainContainer = document.getElementById('main-container');
        const googleSignInBtn = document.getElementById('google-signin-btn');
        const signOutBtn = document.getElementById('signout-btn');
        const uploadSection = document.getElementById('upload-section');
        const uploadForm = document.getElementById('upload-form');
        const videoTypeSelect = document.getElementById('videoType');
        const seriesDetailsDiv = document.getElementById('series-details');
        const movieDetailsDiv = document.getElementById('movie-details');
        const messageBox = document.getElementById('message-box');
        const moviesTabBtn = document.getElementById('movies-tab');
        const seriesTabBtn = document.getElementById('series-tab');
        const moviesContainer = document.getElementById('movies-container');
        const seriesContainer = document.getElementById('series-container');
        const videoPlayerModal = document.getElementById('video-player-modal');
        const videoPlayer = document.getElementById('video-player');
        const episodeListModal = document.getElementById('episode-list-modal');
        const episodeListContainer = document.getElementById('episode-list-container');
        const userStatusText = document.getElementById('user-status');
        const uploadButton = document.getElementById('upload-button');
        const deleteConfirmModal = document.getElementById('delete-confirm-modal');
        const deleteConfirmBtn = document.getElementById('delete-confirm-btn');
        const deleteCancelBtn = document.getElementById('delete-cancel-btn');
        const deleteConfirmText = document.getElementById('delete-confirm-text');
        
        let currentActiveTab = 'movies';
        let deletionTarget = null; // Store the target for deletion
        
        // --- Helper Functions ---
        /**
         * Displays a temporary message to the user.
         * @param {string} message The message to display.
         * @param {string} type The type of message (e.g., 'success', 'error', 'info').
         */
        const showMessage = (message, type = 'info') => {
            if (!messageBox) return; // Guard against messageBox not being in the DOM yet
            const el = document.createElement('div');
            el.className = `p-4 rounded-lg shadow-lg mb-4 transform transition-transform duration-300 ease-out translate-x-0`;
            if (type === 'success') {
                el.classList.add('bg-green-500', 'text-white');
            } else if (type === 'error') {
                el.classList.add('bg-red-500', 'text-white');
            } else {
                el.classList.add('bg-blue-500', 'text-white');
            }
            el.innerHTML = `<p>${message}</p>`;
            messageBox.appendChild(el);

            setTimeout(() => {
                el.classList.add('translate-x-full');
                el.addEventListener('transitionend', () => el.remove());
            }, 3000);
        };
        
        /**
         * Generates a streamable Cloudinary URL from a public ID.
         * @param {string} publicId The Cloudinary public ID of the video.
         * @returns {string} The full streamable URL.
         */
        const getCloudinaryVideoUrl = (publicId) => {
            return `https://res.cloudinary.com/${CLOUDINARY_CLOUD_NAME}/video/upload/f_auto/q_auto/${publicId}`;
        };

        /**
         * Deletes a document from Firestore.
         * @param {string} docPath The path to the document to delete.
         */
        const deleteFromFirestore = async (docPath, title) => {
            try {
                const docRef = doc(db, docPath);
                await deleteDoc(docRef);
                showMessage(`Successfully deleted '${title}' from the database.`, 'success');
                console.log(`Document '${docPath}' successfully deleted.`);
            } catch (error) {
                console.error("Error deleting document: ", error);
                showMessage(`Error deleting file: ${error.message}`, 'error');
            }
        };

        /**
         * Renders a list of video cards.
         * @param {Array} videos The array of video objects.
         * @param {HTMLElement} container The container to render into.
         * @param {string} type 'movie' or 'series'.
         * @param {object} user The current authenticated user object.
         */
        const renderVideos = (videos, container, type, user) => {
            container.innerHTML = '';
            if (videos.length === 0) {
                container.innerHTML = `<p class="text-center text-gray-400">No ${type}s uploaded yet.</p>`;
                return;
            }
            videos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col justify-between';
                
                let buttonHTML = '';
                if (type === 'movie') {
                    const videoURL = getCloudinaryVideoUrl(video.publicId);
                    buttonHTML = `<button class="play-btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-full shadow-lg transition-colors duration-300" data-url="${videoURL}">Watch Now</button>`;
                } else if (type === 'series') {
                    buttonHTML = `<button class="view-episodes-btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-full shadow-lg transition-colors duration-300" data-series-id="${video.id}" data-series-title="${video.title}">View Episodes</button>`;
                }
                
                let deleteButtonHTML = '';
                if (user && user.email === adminEmail) {
                    deleteButtonHTML = `
                        <button class="delete-btn bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-full mt-4 transition-colors duration-300" 
                                data-id="${video.id}" 
                                data-collection="${type === 'movie' ? 'movies' : 'series'}"
                                data-title="${video.title}">
                            Delete
                        </button>`;
                }

                videoCard.innerHTML = `
                    <div>
                        <h3 class="text-2xl font-bold mb-2 text-white">${video.title}</h3>
                        <p class="text-gray-400 text-sm mb-2">${video.description || 'No description.'}</p>
                        <p class="text-gray-500 text-xs mt-2">ID: ${video.id}</p>
                    </div>
                    <div class="flex flex-col items-center">
                        ${buttonHTML}
                        ${deleteButtonHTML}
                    </div>
                `;
                container.appendChild(videoCard);
            });
        };

        // --- Main Logic ---

        // Only proceed if Firebase was successfully initialized
        if (isFirebaseInitialized) {
            // Firebase Auth State Listener
            onAuthStateChanged(auth, async (user) => {
                console.log("Auth state changed. User:", user ? user.email || user.uid : 'null');
                const isAdmin = user && user.email === adminEmail;
                
                if (user) {
                    mainContainer.classList.remove('hidden');
                    authContainer.classList.add('hidden');
                    signOutBtn.classList.remove('hidden');

                    if (isAdmin) {
                        showMessage('Welcome, Admin! You can now upload and delete content.', 'success');
                        uploadSection.classList.remove('hidden');
                        userStatusText.textContent = `Signed in as: ${user.email} (Admin)`;
                    } else {
                        uploadSection.classList.add('hidden');
                        userStatusText.textContent = `Signed in as: ${user.email}`;
                    }

                    // Set up real-time listeners for movies and series
                    const moviesQuery = query(collection(db, `artifacts/${appId}/public/data/movies`));
                    onSnapshot(moviesQuery, (querySnapshot) => {
                        const movies = [];
                        querySnapshot.forEach((doc) => {
                            movies.push({ id: doc.id, ...doc.data() });
                        });
                        renderVideos(movies, moviesContainer, 'movie', user);
                    }, (error) => {
                        showMessage(`Error fetching movies: ${error.message}`, 'error');
                        console.error('Firestore Error (movies):', error);
                    });

                    const seriesQuery = query(collection(db, `artifacts/${appId}/public/data/series`));
                    onSnapshot(seriesQuery, (querySnapshot) => {
                        const series = [];
                        querySnapshot.forEach((doc) => {
                            series.push({ id: doc.id, ...doc.data() });
                        });
                        renderVideos(series, seriesContainer, 'series', user);
                    }, (error) => {
                        showMessage(`Error fetching series: ${error.message}`, 'error');
                        console.error('Firestore Error (series):', error);
                    });

                } else {
                    mainContainer.classList.remove('hidden'); // Show main content in a read-only mode
                    authContainer.classList.remove('hidden');
                    userStatusText.textContent = 'You are not signed in.';
                    signOutBtn.classList.add('hidden');
                    uploadSection.classList.add('hidden');

                    // Render videos for non-logged-in users as well
                    const moviesQuery = query(collection(db, `artifacts/${appId}/public/data/movies`));
                    onSnapshot(moviesQuery, (querySnapshot) => {
                        const movies = [];
                        querySnapshot.forEach((doc) => {
                            movies.push({ id: doc.id, ...doc.data() });
                        });
                        renderVideos(movies, moviesContainer, 'movie', null);
                    }, (error) => {
                        showMessage(`Error fetching movies: ${error.message}`, 'error');
                        console.error('Firestore Error (movies):', error);
                    });

                    const seriesQuery = query(collection(db, `artifacts/${appId}/public/data/series`));
                    onSnapshot(seriesQuery, (querySnapshot) => {
                        const series = [];
                        querySnapshot.forEach((doc) => {
                            series.push({ id: doc.id, ...doc.data() });
                        });
                        renderVideos(series, seriesContainer, 'series', null);
                    }, (error) => {
                        showMessage(`Error fetching series: ${error.message}`, 'error');
                        console.error('Firestore Error (series):', error);
                    });
                }
            });

            // --- Authentication Logic ---
            googleSignInBtn.addEventListener('click', async () => {
                try {
                    console.log('Attempting Google sign-in...');
                    const provider = new GoogleAuthProvider();
                    await signInWithPopup(auth, provider);
                    showMessage('Signed in with Google successfully!', 'success');
                } catch (error) {
                    console.error('Google sign-in failed:', error);
                    if (error.code === 'auth/unauthorized-domain') {
                        showMessage('Google sign-in failed. Please add this domain to your Firebase authorized domains list to fix this.', 'error');
                    } else {
                        showMessage(`Google sign-in failed: ${error.message}`, 'error');
                    }
                }
            });

            signOutBtn.addEventListener('click', async () => {
                console.log('Attempting sign out...');
                try {
                    await signOut(auth);
                    showMessage('Signed out successfully!', 'info');
                } catch (error) {
                    console.error('Sign out failed:', error);
                    showMessage(`Sign out failed: ${error.message}`, 'error');
                }
            });

            // --- Dynamic Upload Form Logic ---
            videoTypeSelect.addEventListener('change', (e) => {
                if (e.target.value === 'movie') {
                    movieDetailsDiv.classList.remove('hidden');
                    seriesDetailsDiv.classList.add('hidden');
                } else {
                    movieDetailsDiv.classList.add('hidden');
                    seriesDetailsDiv.classList.remove('hidden');
                }
            });

            // --- Handle Movie and Episode Uploads ---
            uploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                if (!auth.currentUser || auth.currentUser.email !== adminEmail) {
                    showMessage('You do not have permission to upload videos.', 'error');
                    return;
                }

                const videoType = videoTypeSelect.value;
                const fileInput = document.getElementById('file-input');
                const file = fileInput.files[0];
                
                if (!file) {
                    showMessage('Please select a video file to upload.', 'error');
                    return;
                }

                const title = videoType === 'movie' ? e.target.title.value.trim() : e.target['title-series'].value.trim();
                const description = videoType === 'movie' ? e.target.description.value.trim() : e.target['description-series'].value.trim();
                
                if (!title || !description) {
                    showMessage('Please fill in all fields.', 'error');
                    return;
                }

                // Show a loading message and disable the button
                uploadButton.textContent = 'Uploading...';
                uploadButton.disabled = true;
                showMessage('Uploading video to Cloudinary. This may take a moment...', 'info');

                try {
                    // Upload file to Cloudinary
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

                    const cloudinaryResponse = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/video/upload`, {
                        method: 'POST',
                        body: formData
                    });

                    if (!cloudinaryResponse.ok) {
                        // Log the full response for better debugging
                        const errorText = await cloudinaryResponse.text();
                        console.error('Cloudinary API Response (Error):', errorText);
                        throw new Error(`Cloudinary upload failed. Response: ${errorText}`);
                    }

                    const cloudinaryData = await cloudinaryResponse.json();
                    const publicId = cloudinaryData.public_id;

                    // Save video metadata to Firestore
                    const videoMetadata = {
                        title,
                        description,
                        publicId,
                        uploaderEmail: auth.currentUser.email,
                        createdAt: new Date()
                    };

                    if (videoType === 'movie') {
                        const moviesCollectionRef = collection(db, `artifacts/${appId}/public/data/movies`);
                        await addDoc(moviesCollectionRef, videoMetadata);
                        showMessage('Movie details saved!', 'success');
                    } else if (videoType === 'series') {
                        const seriesTitle = e.target.seriesTitle.value.trim();
                        const episodeNumber = e.target.episodeNumber.value.trim();
                        if (!seriesTitle || !episodeNumber) {
                            showMessage('Please provide a Series Title and Episode Number.', 'error');
                            return;
                        }
                        
                        const seriesRef = collection(db, `artifacts/${appId}/public/data/series`);
                        const q = query(seriesRef, where("title", "==", seriesTitle));
                        const seriesDocs = await getDocs(q);

                        let seriesId;
                        if (seriesDocs.empty) {
                            const newSeriesRef = await addDoc(seriesRef, { title: seriesTitle });
                            seriesId = newSeriesRef.id;
                        } else {
                            seriesId = seriesDocs.docs[0].id;
                        }
                        
                        const episodesCollectionRef = collection(db, `artifacts/${appId}/public/data/series/${seriesId}/episodes`);
                        await addDoc(episodesCollectionRef, { ...videoMetadata, episodeNumber: parseInt(episodeNumber, 10) });
                        showMessage('Episode details saved!', 'success');
                    }
                    uploadForm.reset();
                } catch (error) {
                    console.error(error);
                    showMessage(`Failed to save video metadata: ${error.message}`, 'error');
                } finally {
                    uploadButton.textContent = 'Save Content';
                    uploadButton.disabled = false;
                }
            });

            // --- Video Player and Episode List Modals Logic ---
            document.addEventListener('click', async (e) => {
                // Close the video player modal
                if (e.target.id === 'close-video-modal-btn' || e.target.closest('#close-video-modal-btn')) {
                    videoPlayer.pause();
                    videoPlayer.src = '';
                    videoPlayerModal.classList.add('hidden');
                    return;
                }
                
                // Close the episode list modal
                if (e.target.id === 'close-episode-modal-btn' || e.target.closest('#close-episode-modal-btn')) {
                    episodeListModal.classList.add('hidden');
                    return;
                }

                // Close the delete confirmation modal
                if (e.target.id === 'delete-cancel-btn' || e.target.closest('#delete-cancel-btn')) {
                    deleteConfirmModal.classList.add('hidden');
                    deletionTarget = null;
                    return;
                }

                // Play a movie
                if (e.target.classList.contains('play-btn')) {
                    const videoURL = e.target.dataset.url;
                    videoPlayer.src = videoURL;
                    videoPlayerModal.classList.remove('hidden');
                }

                // View episodes for a series
                if (e.target.classList.contains('view-episodes-btn')) {
                    const seriesId = e.target.dataset.seriesId;
                    const seriesTitle = e.target.dataset.seriesTitle;
                    const episodesCollectionRef = collection(db, `artifacts/${appId}/public/data/series/${seriesId}/episodes`);
                    
                    // Set up a real-time listener for episodes
                    onSnapshot(episodesCollectionRef, (episodesSnapshot) => {
                        episodeListContainer.innerHTML = '';
                        if (episodesSnapshot.empty) {
                            episodeListContainer.innerHTML = `<p class="text-center text-gray-400">No episodes uploaded for this series yet.</p>`;
                        }
                        const episodes = [];
                        episodesSnapshot.forEach(doc => {
                            episodes.push({ id: doc.id, ...doc.data() });
                        });
                        
                        // Sort episodes by episode number
                        episodes.sort((a, b) => a.episodeNumber - b.episodeNumber);

                        episodes.forEach(episode => {
                            const publicId = episode.publicId; 
                            const videoURL = getCloudinaryVideoUrl(publicId);
                            const episodeItem = document.createElement('div');
                            episodeItem.className = 'bg-gray-700 p-4 rounded-lg flex flex-col md:flex-row justify-between items-start md:items-center space-y-2 md:space-y-0';
                            
                            let deleteButtonHtml = '';
                            if (auth.currentUser && auth.currentUser.email === adminEmail) {
                                deleteButtonHtml = `
                                    <button class="delete-btn bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300 ml-0 md:ml-4"
                                            data-id="${episode.id}"
                                            data-collection="series"
                                            data-parent-id="${seriesId}"
                                            data-title="${episode.title}">
                                        Delete
                                    </button>`;
                            }
                            
                            episodeItem.innerHTML = `
                                <div>
                                    <h4 class="text-xl font-semibold">${seriesTitle} - S1 E${episode.episodeNumber}</h4>
                                    <p class="text-gray-400 text-sm">${episode.description}</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button class="play-btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-full" data-url="${videoURL}">Play</button>
                                    ${deleteButtonHtml}
                                </div>
                            `;
                            episodeListContainer.appendChild(episodeItem);
                        });
                    }, (error) => {
                        console.error('Error fetching episodes:', error);
                        showMessage(`Failed to load episodes: ${error.message}`, 'error');
                    });
                    
                    episodeListModal.classList.remove('hidden');
                }

                // Show the deletion confirmation modal
                if (e.target.classList.contains('delete-btn')) {
                    const id = e.target.dataset.id;
                    const collectionName = e.target.dataset.collection;
                    const title = e.target.dataset.title;
                    const parentId = e.target.dataset.parentId;
                    
                    deletionTarget = { id, collectionName, parentId, title };

                    deleteConfirmText.textContent = `Are you sure you want to delete "${title}"? This action cannot be undone.`;
                    deleteConfirmModal.classList.remove('hidden');
                }
            });
            
            // Confirm deletion
            deleteConfirmBtn.addEventListener('click', async () => {
                if (!deletionTarget) return;

                const { id, collectionName, parentId, title } = deletionTarget;
                
                let docPath;
                if (collectionName === 'movies') {
                    docPath = `artifacts/${appId}/public/data/movies/${id}`;
                } else if (collectionName === 'series' && parentId) {
                    docPath = `artifacts/${appId}/public/data/series/${parentId}/episodes/${id}`;
                } else if (collectionName === 'series') {
                    docPath = `artifacts/${appId}/public/data/series/${id}`;
                }

                if (docPath) {
                    await deleteFromFirestore(docPath, title);
                    
                    // IMPORTANT: The following is a security-conscious note.
                    // To also delete the video from Cloudinary, you would need to implement
                    // a backend function that receives the publicId and performs a
                    // signed Cloudinary API call. A direct client-side delete request
                    // would require exposing your Cloudinary API Secret, which is a major
                    // security risk. This implementation only removes the record from Firestore.
                    console.warn(`Record with ID '${id}' deleted from Firestore. Note: Cloudinary file must be manually deleted or handled by a backend service.`);
                }
                
                deleteConfirmModal.classList.add('hidden');
                deletionTarget = null;
            });

            // --- Tab switching logic ---
            moviesTabBtn.addEventListener('click', () => {
                currentActiveTab = 'movies';
                moviesTabBtn.classList.add('active');
                seriesTabBtn.classList.remove('active');
                moviesContainer.classList.remove('hidden');
                seriesContainer.classList.add('hidden');
            });

            seriesTabBtn.addEventListener('click', () => {
                currentActiveTab = 'series';
                seriesTabBtn.classList.add('active');
                moviesTabBtn.classList.remove('active');
                seriesContainer.classList.remove('hidden');
                moviesContainer.classList.add('hidden');
            });
        } else {
            // This part of the code will execute if the firebaseConfig object is empty or invalid
            document.addEventListener('DOMContentLoaded', () => {
                authContainer.classList.remove('hidden');
                mainContainer.classList.add('hidden');
                showMessage('Application is not configured correctly. Please check Firebase settings.', 'error');
            });
        }
    </script>

    <!-- App Container -->
    <div class="container mx-auto py-8">

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-5xl font-extrabold text-white tracking-tight">StreamVault</h1>
            <p class="mt-4 text-xl text-gray-400">Your personal streaming service</p>
        </header>
        
        <!-- User status and Sign-Out button section -->
        <div class="flex justify-between items-center p-6 bg-gray-800 rounded-xl shadow-lg mb-8">
            <p id="user-status" class="text-white text-lg font-semibold">Please sign in.</p>
            <button id="signout-btn" class="bg-red-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200 hidden">
                Sign Out
            </button>
        </div>

        <!-- Dynamic Message Box -->
        <div id="message-box" class="message-box space-y-4"></div>

        <!-- Authentication Section (Initially Hidden) -->
        <div id="auth-container" class="max-w-md mx-auto p-8 bg-gray-800 rounded-2xl shadow-xl">
            <h2 class="text-3xl font-bold text-center text-white mb-6">Sign In</h2>
            <button id="google-signin-btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg shadow-lg hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center space-x-2">
                <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.27H12v4.51h6.24c-.26 1.43-1.04 2.65-2.27 3.48v2.98h3.84c2.25-2.07 3.56-5.11 3.56-8.7H22.56z" fill="#4285F4"/>
                    <path d="M12 23.99c2.72 0 4.97-.9 6.63-2.45l-3.84-2.98c-1.07.72-2.43 1.15-3.79 1.15-2.93 0-5.41-1.98-6.3-4.63H1.83v2.98c1.78 3.52 5.37 6.08 10.17 6.08z" fill="#34A853"/>
                    <path d="M5.7 14.86c-.22-.64-.34-1.32-.34-2.02s.12-1.38.34-2.02V8.84H1.83C1.09 10.37.75 12.11.75 12.99s.34 2.62 1.08 4.15l3.87-2.02z" fill="#FBBC05"/>
                    <path d="M12 5.01c1.47 0 2.76.5 3.79 1.47l3.39-3.39C16.97 1.8 14.72.75 12 .75 7.21.75 3.62 3.31 1.83 6.83l3.87 2.98c.89-2.65 3.37-4.62 6.3-4.62z" fill="#EA4335"/>
                </svg>
                <span>Sign in with Google</span>
            </button>
        </div>

        <!-- Main App Section (Initially Hidden) -->
        <div id="main-container" class="hidden">
            <!-- Video Upload Section (Hidden for non-admin) -->
            <div id="upload-section" class="max-w-2xl mx-auto mb-12 hidden">
                <div class="bg-gray-800 p-8 rounded-2xl shadow-xl">
                    <h2 class="text-3xl font-bold text-white mb-6 text-center">Upload a Video</h2>
                    <form id="upload-form" class="space-y-6">
                        <!-- File Upload Input -->
                        <div>
                            <label for="file-input" class="block text-sm font-medium text-gray-300 mb-1">Select Video File</label>
                            <input type="file" id="file-input" name="file-input" accept="video/*" required class="w-full text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                        </div>

                        <!-- Content Type and Details -->
                        <div>
                            <label for="videoType" class="block text-sm font-medium text-gray-300 mb-1">Content Type</label>
                            <select id="videoType" name="videoType" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white">
                                <option value="movie">Movie</option>
                                <option value="series">TV Series</option>
                            </select>
                        </div>

                        <!-- Movie details (default) -->
                        <div id="movie-details">
                            <div>
                                <label for="title" class="block text-sm font-medium text-gray-300 mb-1">Movie Title</label>
                                <input type="text" id="title" name="title" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white">
                            </div>
                            <div>
                                <label for="description" class="block text-sm font-medium text-gray-300 mb-1">Description</label>
                                <textarea id="description" name="description" rows="3" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white"></textarea>
                            </div>
                        </div>

                        <!-- Series details (hidden by default) -->
                        <div id="series-details" class="hidden">
                             <div>
                                <label for="seriesTitle" class="block text-sm font-medium text-gray-300 mb-1">Series Title</label>
                                <input type="text" id="seriesTitle" name="seriesTitle" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white">
                            </div>
                            <div>
                                <label for="episodeNumber" class="block text-sm font-medium text-gray-300 mb-1">Episode Number</label>
                                <input type="number" id="episodeNumber" name="episodeNumber" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white">
                            </div>
                            <div>
                                <label for="title-series" class="block text-sm font-medium text-gray-300 mb-1">Episode Title</label>
                                <input type="text" id="title-series" name="title-series" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white">
                            </div>
                            <div>
                                <label for="description-series" class="block text-sm font-medium text-gray-300 mb-1">Description</label>
                                <textarea id="description-series" name="description-series" rows="3" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white"></textarea>
                            </div>
                        </div>

                        <button type="submit" id="upload-button" class="w-full bg-green-600 text-white font-bold py-3 rounded-lg shadow-lg hover:bg-green-700 transition-colors duration-200">
                            Save Content
                        </button>
                    </form>
                </div>
            </div>

            <!-- Video List Tabs -->
            <div class="flex justify-center mb-8">
                <button id="movies-tab" class="tab-button active px-6 py-3 rounded-l-lg font-bold text-gray-300 hover:bg-gray-700 transition-colors duration-200">Movies</button>
                <button id="series-tab" class="tab-button px-6 py-3 rounded-r-lg font-bold text-gray-300 hover:bg-gray-700 transition-colors duration-200">TV Series</button>
            </div>

            <!-- Video Containers -->
            <div id="movies-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Movie cards will be dynamically inserted here -->
            </div>
            <div id="series-container" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- TV Series cards will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Video Player Modal -->
    <div id="video-player-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="relative w-full max-w-4xl h-auto bg-gray-900 rounded-xl shadow-2xl p-4">
            <button id="close-video-modal-btn" class="absolute top-2 right-2 text-white bg-gray-800 rounded-full w-8 h-8 flex items-center justify-center text-lg hover:bg-gray-700 transition-colors duration-200">
                &times;
            </button>
            <video id="video-player" controls class="w-full h-auto rounded-lg"></video>
        </div>
    </div>
    
    <!-- Episode List Modal -->
    <div id="episode-list-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="relative w-full max-w-2xl h-auto bg-gray-900 rounded-xl shadow-2xl p-6">
            <button id="close-episode-modal-btn" class="absolute top-2 right-2 text-white bg-gray-800 rounded-full w-8 h-8 flex items-center justify-center text-lg hover:bg-gray-700 transition-colors duration-200">
                &times;
            </button>
            <h3 class="text-3xl font-bold text-white mb-6 text-center">Episodes</h3>
            <div id="episode-list-container" class="space-y-4">
                <!-- Episode list will be dynamically inserted here -->
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div id="delete-confirm-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="relative w-full max-w-md bg-gray-800 rounded-xl shadow-2xl p-6 text-center">
            <h3 class="text-2xl font-bold text-white mb-4">Confirm Deletion</h3>
            <p id="delete-confirm-text" class="text-gray-300 mb-6">Are you sure you want to delete this item? This action cannot be undone.</p>
            <div class="flex justify-center space-x-4">
                <button id="delete-cancel-btn" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                    Cancel
                </button>
                <button id="delete-confirm-btn" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors duration-200">
                    Delete
                </button>
            </div>
        </div>
    </div>

</body>
</html>
